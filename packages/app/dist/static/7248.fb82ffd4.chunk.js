"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7248],{56420:(st,M,t)=>{t.d(M,{Y:()=>dt});var a=t(95208),D=t(77125),A=t(64947),I=t(93453),d=t(29365),o=t(46423),S=t(5951),g=t(26343),$=t(28233),V=t(55197),L=t(58837),j=t(72501),l=t(5893),n=t(14041),h=t(45250),s=t.n(h),c=t(70209),F=t(92483),U=t(75202),X=t(89475),z=t(10265);const mt=(0,L.A)({popoverList:{minWidth:260,maxWidth:400},menuItem:{whiteSpace:"normal"}},{name:"BackstageSupportButton"}),x=({icon:R})=>{const Q=(0,a.n)(),O=R?Q.getSystemIcon(R)??F.NT:F.NT;return n.createElement(O,null)},w=({link:R})=>n.createElement(U.N_,{to:R.url},R.title??R.url),q=({item:R})=>n.createElement(g.A,{button:!1},n.createElement(o.A,null,n.createElement(x,{icon:R.icon})),n.createElement(S.A,{primary:R.title,secondary:R.links?.reduce((Q,O,Z)=>[...Q,Z>0&&n.createElement("br",{key:Z}),n.createElement(w,{link:O,key:O.url})],[])}));function dt(R){const{t:Q}=(0,z.i)(X.O),{title:O,items:Z,children:b}=R,{items:at}=(0,c.l)(),[G,it]=(0,n.useState)(!1),[N,tt]=(0,n.useState)(null),et=mt(),nt=(0,l.A)(J=>J.breakpoints.down("sm")),lt=J=>{tt(J.currentTarget),it(!0)},Et=()=>{it(!1)};return n.createElement(n.Fragment,null,n.createElement(D.A,{display:"flex",ml:1},nt?n.createElement(d.A,{color:"primary",size:"small",onClick:lt,"data-testid":"support-button","aria-label":"Support"},n.createElement(F.NT,null)):n.createElement(A.A,{"data-testid":"support-button","aria-label":"Support",color:"primary",onClick:lt,startIcon:n.createElement(F.NT,null)},Q("supportButton.title"))),n.createElement(V.Ay,{"data-testid":"support-button-popover",open:G,anchorEl:N,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},onClose:Et},n.createElement($.A,{className:et.popoverList,autoFocusItem:!!N},O&&n.createElement(g.A,{button:!1,alignItems:"flex-start",className:et.menuItem},n.createElement(j.A,{variant:"subtitle1"},O)),n.Children.map(b,(J,rt)=>n.createElement(g.A,{button:!1,alignItems:"flex-start",key:`child-${rt}`,className:et.menuItem},J)),(Z??at).map((J,rt)=>n.createElement(q,{item:J,key:`item-${rt}`}))),n.createElement(I.A,null,n.createElement(A.A,{color:"primary",onClick:Et,"aria-label":"Close"},Q("supportButton.close")))))}},77509:(st,M,t)=>{t.d(M,{GI:()=>n});var a=t(14041),D=t(77125),A=t(64947),I=t(73845),d=t(42899),o=t(72501),S=t(5893),g=t(54917),$=t(65859),V=t(80084),L=t(10265);const j=h=>{const s=(0,S.A)(z=>z.breakpoints.down(h.options?.drawerBreakpoint??"md")),c=(0,g.A)(),[F,U]=(0,a.useState)(!1),{t:X}=(0,L.i)(V.j);return s?a.createElement(a.Fragment,null,a.createElement(A.A,{style:{marginTop:c.spacing(1),marginLeft:c.spacing(1)},onClick:()=>U(!0),startIcon:a.createElement($.A,null)},X("catalogFilter.buttonTitle")),a.createElement(I.Ay,{open:F,onClose:()=>U(!1),anchor:h.options?.drawerAnchor??"left",disableAutoFocus:!0,keepMounted:!0,variant:"temporary"},a.createElement(D.A,{m:2},a.createElement(o.A,{variant:"h6",component:"h2",style:{marginBottom:c.spacing(1)}},X("catalogFilter.title")),h.children))):a.createElement(d.A,{item:!0,lg:2},h.children)},l=h=>a.createElement(d.A,{item:!0,xs:12,lg:10},h.children),n=h=>a.createElement(d.A,{container:!0,style:{position:"relative"}},h.children);n.Filters=j,n.Content=l},24999:(st,M,t)=>{t.d(M,{y:()=>dt});var a=t(77125),D=t(72501),A=t(58837),I=t(6924),d=t(61783),o=t(14041),S=t(18139),g=t(73466),$=t(30043),V=t(69076),L=t(86901),j=t(44148),l=t(41260);const n=o.createElement(l.A,{fontSize:"small"}),h=o.createElement(j.A,{fontSize:"small"});function s({selected:R}){return o.createElement(V.A,{icon:n,checkedIcon:h,checked:R})}const c=(0,o.memo)(R=>{const{selected:Q,value:O,availableOptions:Z,showCounts:b}=R,at=b?`${O} (${Z?.[O]})`:O;return o.createElement(L.A,{control:o.createElement(s,{selected:Q}),label:at,onClick:G=>G.preventDefault()})});var F=t(16249),U=t(53373),X=t.n(U);const z=(0,A.A)({input:{}},{name:"CatalogReactEntityAutocompletePickerInput"});function mt(R){const Q=z();return o.createElement(F.A,{variant:"outlined",...R,className:X()(Q.input,R.className)})}var x=t(18453),w=t(15998);const q=(0,A.A)({root:{},label:{}},{name:"CatalogReactEntityAutocompletePicker"});function dt(R){const{label:Q,name:O,path:Z,showCounts:b,Filter:at,InputProps:G,initialSelectedOptions:it=[],filtersForAvailableValues:N=["kind"]}=R,tt=q(),{updateFilters:et,filters:nt,queryParameters:{[O]:lt}}=(0,x.nK)(),Et=(0,S.gf)($.v),J=N.map(e=>nt[e]),{value:rt}=(0,g.A)(async()=>{const e=Z,{facets:i}=await Et.getEntityFacets({facets:[e],filter:(0,w.Rr)(J.filter(Boolean))});return Object.fromEntries(i[e].map(({value:m,count:p})=>[m,p]))},[...J]),P=(0,o.useMemo)(()=>[lt].flat().filter(Boolean),[lt]),[H,K]=(0,o.useState)(P.length?P:nt[O]?.values??it);(0,o.useEffect)(()=>{P.length&&K(P)},[P]);const r=Object.keys(rt??{}),E=H.length&&r.length;(0,o.useEffect)(()=>{et({[O]:E?new at(H):void 0})},[O,E,H,at,et]);const u=nt[O];return u&&typeof u=="object"&&!("values"in u)||!r.length?null:o.createElement(a.A,{className:tt.root,pb:1,pt:1},o.createElement(D.A,{className:tt.label,variant:"button",component:"label"},Q,o.createElement(d.Ay,{PopperComponent:e=>o.createElement("div",{...e},e.children),multiple:!0,disableCloseOnSelect:!0,options:r,value:H,onChange:(e,i)=>K(i),renderOption:(e,{selected:i})=>o.createElement(c,{selected:i,value:e,availableOptions:rt,showCounts:!!b}),size:"small",popupIcon:o.createElement(I.A,{"data-testid":`${String(O)}-picker-expand`}),renderInput:e=>o.createElement(mt,{...e,...G})})))}},40941:(st,M,t)=>{t.d(M,{t:()=>u});var a=t(78560),D=t(77125),A=t(69076),I=t(86901),d=t(16249),o=t(72501),S=t(71677),g=t(58837),$=t(7031),V=t(44148),L=t(41260),j=t(6924),l=t(61783),n=t(14041),h=t(18453),s=t(49724),c=t(16261);function F(e){const i=(0,c.J)(e);(0,n.useEffect)(()=>()=>{i.current()},[])}function U(e,i,m,p=0){const C=(0,n.useRef)(),v=(0,n.useRef)(),f=(0,n.useRef)(e),y=(0,n.useRef)(),_=()=>{C.current&&(clearTimeout(C.current),C.current=void 0),v.current&&(clearTimeout(v.current),v.current=void 0)};return F(_),(0,n.useEffect)(()=>{f.current=e},i),(0,n.useMemo)(()=>{const k=()=>{if(_(),!y.current)return;const Y=y.current;y.current=void 0,f.current.apply(Y.this,Y.args)},W=function(...Y){C.current&&clearTimeout(C.current),y.current={args:Y,this:this},C.current=setTimeout(k,m),p>0&&!v.current&&(v.current=setTimeout(k,p))};return Object.defineProperties(W,{length:{value:e.length},name:{value:`${e.name||"anonymous"}__debounced__${m}`}}),W},[m,p,...i])}function X(e,i,m,p=0){(0,n.useEffect)(U(e,i,m,p),i)}var z=t(48108),mt=t(47966),x=t(53318),w=t(18139),q=t(87290),dt=t(30043),R=t(46123),Q=t.n(R);const O=e=>typeof e=="string"?e:void 0;function Z({enabled:e}){const i=(0,w.gf)(dt.v),[m]=(0,n.useState)(async()=>{if(!e)return[];const p="relations.ownedBy",v=(await i.getEntityFacets({facets:[p]})).facets[p]?.map(f=>f.value)??[];return i.getEntitiesByRefs({entityRefs:v}).then(f=>f.items.filter(y=>y!==void 0).map(y=>y).sort((y,_)=>(y.metadata.namespace||"").localeCompare(_.metadata.namespace||"","en-US")||(O(Q()(y,"spec.profile.displayName"))||y.metadata.title||y.metadata.name).localeCompare(O(Q()(_,"spec.profile.displayName"))||_.metadata.title||_.metadata.name,"en-US")||y.kind.localeCompare(_.kind,"en-US"))).then(f=>f).catch(()=>[])});return(0,q.A)(async(p,C)=>{const v=await m;if(!v)return{items:[]};const f=C?.limit??20,{text:y,start:_}=b(p),k=v.filter(Y=>it(y,Y)),W=_+f;return{items:k.slice(0,W),...G({entities:k,limit:W,payload:{text:y,start:W}})}},[m],{loading:!0,value:{items:[]}})}function b(e){return at(e)&&e.cursor?JSON.parse(atob(e.cursor)):{text:e.text||"",start:0}}function at(e){return!!e.cursor}function G({entities:e,limit:i,payload:m}){return e.length>i?{cursor:btoa(JSON.stringify(m))}:{}}function it(e,i){const m=e.trim();return i.kind.includes(m)||i.metadata.namespace?.includes(m)||i.metadata.name.includes(m)||i.metadata.title?.includes(m)||Q()(i,"spec.profile.displayName")?.includes(m)}function N(){const e=(0,w.gf)(dt.v);return(0,q.A)(async(i,m)=>{const p=i,C=i,v=m?.limit??20;if(C.cursor){const y=await e.queryEntities({cursor:C.cursor,limit:v});return{cursor:y.pageInfo.nextCursor,items:[...C.items,...y.items]}}const f=await e.queryEntities({fullTextFilter:{term:p.text||"",fields:["metadata.name","kind","spec.profile.displayname","metadata.title"]},filter:{kind:["User","Group"]},orderFields:[{field:"metadata.name",order:"asc"}],limit:v});return{cursor:f.pageInfo.nextCursor,items:f.items}},[],{loading:!0})}var tt=t(76842);function et({mode:e,initialSelectedOwnersRefs:i}){const m=e==="owners-only",p=N(),C=Z({enabled:m}),[v,f]=m?C:p;return[v,f,nt({enabled:!m,initialSelectedOwnersRefs:i})]}function nt({enabled:e,initialSelectedOwnersRefs:i}){const m=(0,n.useRef)({}),p=(0,w.gf)(dt.v),[,C]=(0,q.A)(async()=>{(await p.getEntitiesByRefs({entityRefs:i})).items.forEach(f=>{f&&(m.current[(0,a.U2)(f)]=f)})},[]);return(0,tt.u)(()=>{e&&i.length>0&&C()}),{getEntity:v=>m.current[v],setEntity:v=>{m.current[(0,a.U2)(v)]=v}}}var lt=t(46509),Et=t(96403),J=t(80084),rt=t(10265);const P=(0,g.A)({root:{},label:{},input:{},fullWidth:{width:"100%"},boxLabel:{width:"100%",textOverflow:"ellipsis",overflow:"hidden"}},{name:"CatalogReactEntityOwnerPicker"}),H=(0,$.A)(e=>({label:{width:"100%"},root:{width:"90%"}}),{name:"FixedWidthFormControlLabel"})(I.A),K=n.createElement(L.A,{fontSize:"small"}),r=n.createElement(V.A,{fontSize:"small"});function E(e){const i=P(),m=e.entity.kind.toLocaleLowerCase("en-US")==="group",{primaryTitle:p}=(0,lt.f)(e.entity);return n.createElement(D.A,{className:i.fullWidth},n.createElement(H,{className:i.fullWidth,control:n.createElement(A.A,{icon:K,checkedIcon:r,checked:e.isSelected}),onClick:C=>C.preventDefault(),label:n.createElement(S.Ay,{title:p},n.createElement(D.A,{display:"flex",alignItems:"center"},m?n.createElement(mt.A,{fontSize:"small"}):n.createElement(z.A,{fontSize:"small"}),"\xA0",n.createElement(D.A,{className:i.boxLabel},n.createElement(o.A,{noWrap:!0},p))))}))}const u=e=>{const i=P(),{mode:m="owners-only"}=e||{},{updateFilters:p,filters:C,queryParameters:{owners:v}}=(0,h.nK)(),[f,y]=(0,n.useState)(""),{t:_}=(0,rt.i)(J.j),k=(0,n.useMemo)(()=>[v].flat().filter(Boolean),[v]),[W,Y]=(0,n.useState)(k.length?k:C.owners?.values??[]),[{value:ft,loading:gt},vt,yt]=et({mode:m,initialSelectedOwnersRefs:W});X(()=>vt({text:f}),[f,vt],250);const At=ft?.items||[];return(0,n.useEffect)(()=>{if(k.length){const T=new s.N9(k);Y(T.values)}},[k]),(0,n.useEffect)(()=>{p({owners:W.length?new s.N9(W):void 0})},[W,p]),["user","group"].includes(C.kind?.value.toLocaleLowerCase("en-US")||"")?null:n.createElement(D.A,{className:i.root,pb:1,pt:1},n.createElement(o.A,{className:i.label,variant:"button",component:"label"},_("entityOwnerPicker.title"),n.createElement(l.Ay,{PopperComponent:T=>n.createElement("div",{...T},T.children),multiple:!0,disableCloseOnSelect:!0,loading:gt,options:At,value:W,getOptionSelected:(T,B)=>typeof B=="string"?(0,a.U2)(T)===B:T===B,getOptionLabel:T=>{const B=typeof T=="string"?yt.getEntity(T)||(0,a.KU)(T,{defaultKind:"group",defaultNamespace:"default"}):T;return(0,x.Z)(B,(0,x.S)(B))},onChange:(T,B)=>{y(""),Y(B.map(ct=>{const pt=typeof ct=="string"?ct:(0,a.U2)(ct);return typeof ct!="string"&&yt.setEntity(ct),pt}))},filterOptions:T=>T,renderOption:(T,{selected:B})=>n.createElement(E,{entity:T,isSelected:B}),size:"small",popupIcon:n.createElement(j.A,{"data-testid":"owner-picker-expand"}),renderInput:T=>n.createElement(d.A,{...T,className:i.input,onChange:B=>{y(B.currentTarget.value)},variant:"outlined"}),ListboxProps:{onScroll:T=>{const B=T.currentTarget;Math.abs(B.scrollHeight-B.clientHeight-B.scrollTop)<1&&ft?.cursor&&vt({items:ft.items,cursor:ft.cursor})},"data-testid":"owner-picker-listbox"}})))}},56829:(st,M,t)=>{t.d(M,{m:()=>g});var a=t(58837),D=t(14041),A=t(49724),I=t(24999),d=t(80084),o=t(10265);const S=(0,a.A)({input:{}},{name:"CatalogReactEntityTagPicker"}),g=$=>{const V=S(),{t:L}=(0,o.i)(d.j);return D.createElement(I.y,{label:L("entityTagPicker.title"),name:"tags",path:"metadata.tags",Filter:A.q_,showCounts:$.showCounts,InputProps:{className:V.input}})}},30117:(st,M,t)=>{t.d(M,{y:()=>K});var a=t(18139),D=t(54195),A=t(40703),I=t(58007),d=t(46423),o=t(65569),S=t(5951),g=t(26343),$=t(72501),V=t(58837),L=t(9684),j=t(92483),l=t(14041),n=t(49724),h=t(18453),s=t(46343),c=t(40074),F=t(46123),U=t(96403),X=t(94223),z=t(45250),mt=t(73466),x=t(30043),w=t(15998),q=t(87290),dt=function(r){return r!==Object(r)},R=function(r,E,u){var e=(0,l.useRef)(void 0);(!e.current||!u(E,e.current))&&(e.current=E),(0,l.useEffect)(r,e.current)};const Q=R;var O=t(56307),Z=t.n(O);const b=Z();var at=function(r){return r!==Object(r)},G=function(r,E){Q(r,E,b)};const it=G;function N(){const r=(0,a.gf)(X.K),E=(0,a.gf)(x.v),{filters:u}=(0,h.nK)(),{value:e,loading:i}=(0,mt.A)(async()=>(await r.getBackstageIdentity()).ownershipEntityRefs,[]),{user:m,owners:p,...C}=u,v=(0,w.$3)((0,z.compact)(Object.values(C))),[{value:f,loading:y},_]=(0,q.A)(async W=>{const Y=tt(W.owners,W.ownershipEntityRefs);if(Y===void 0)return 0;const{["metadata.name"]:ft,...gt}=W.filter.filter,{totalItems:vt}=await E.queryEntities({...W.filter,filter:{...gt,"relations.ownedBy":Y},limit:0});return vt},[],{loading:!0});return it(()=>{Object.keys(v.filter).length!==0&&e!==void 0&&_({ownershipEntityRefs:e,owners:p,filter:v})},[e,p,v]),{count:f,loading:i||y,filter:(0,l.useMemo)(()=>n.tN.owned(e??[]),[e]),ownershipEntityRefs:e}}function tt(r,E){if(E===void 0)return;const u=r?.values??[];if(u.length){const e=(0,z.intersection)(u,E);return e.length===0?void 0:e}return E}function et(){const r=(0,a.gf)(x.v),{filters:E}=(0,h.nK)(),u=(0,l.useRef)(),e=(0,l.useMemo)(()=>{const{user:p,...C}=E,v=(0,z.compact)(Object.values(C)),f=(0,w.$3)(v),y={...f,limit:0};return Object.keys(f.filter).length===0?(u.current=void 0,u.current):(0,z.isEqual)(y,u.current)?u.current:(u.current=y,y)},[E]),{value:i,loading:m}=(0,mt.A)(async()=>{if(e===void 0)return 0;const{totalItems:p}=await r.queryEntities(e);return p},[e]);return{count:i,loading:m}}var nt=t(78560),lt=t(44861);function Et(){const r=(0,a.gf)(x.v),{filters:E}=(0,h.nK)(),{starredEntities:u}=(0,lt.I)(),e=(0,l.useRef)(),i=(0,l.useMemo)(()=>{const{user:v,...f}=E,y=(0,z.compact)(Object.values(f)),_=(0,w.$3)(y),W={..._,filter:{..._.filter,["metadata.name"]:Array.from(u).map(Y=>(0,nt.KU)(Y).name)},limit:1e3};return(0,z.isEqual)(W,e.current)?e.current:(e.current=W,W)},[E,u]),{value:m,loading:p}=(0,mt.A)(async()=>u.size?(await r.queryEntities(i)).items.map(f=>(0,nt.U2)({kind:f.kind,namespace:f.metadata.namespace,name:f.metadata.name})).filter(f=>u.has(f)).length:0,[i,u]),C=(0,l.useMemo)(()=>n.tN.starred(Array.from(u)),[u]);return{count:m,loading:p,filter:C}}var J=t(10265),rt=t(80084);const P=(0,V.A)(r=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:r.spacing(1,0,1,0)},title:{margin:r.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:r.palette.text.primary},menuItem:{minHeight:r.spacing(6)},groupWrapper:{margin:r.spacing(1,1,2,1)}}),{name:"CatalogReactUserListPicker"});function H(r,E){return[{name:E("userListPicker.personalFilter.title"),items:[{id:"owned",label:E("userListPicker.personalFilter.ownedLabel"),icon:L.A},{id:"starred",label:E("userListPicker.personalFilter.starredLabel"),icon:j.Gg}]},{name:r,items:[{id:"all",label:E("userListPicker.orgFilterAllLabel")}]}]}const K=r=>{const{initialFilter:E,availableFilters:u}=r,e=P(),i=(0,a.gf)(D.U),{t:m}=(0,J.i)(rt.j),p=i.getOptionalString("organization.name")??m("userListPicker.defaultOrgName"),{filters:C,updateFilters:v,queryParameters:{kind:f,user:y}}=(0,h.nK)(),_=["starred","all"],k=H(p,m).map(ut=>({...ut,items:ut.items.filter(({id:ot})=>["group","user"].some(Ot=>Ot===f)?_.includes(ot):!u||u.includes(ot))})).filter(({items:ut})=>!!ut.length),{count:W,loading:Y,filter:ft}=N(),{count:gt}=et(),{count:vt,filter:yt,loading:At}=Et(),T=(0,l.useMemo)(()=>[y].flat()[0],[y]),[B,ct]=(0,l.useState)(T??E),pt=(0,l.useMemo)(()=>({all:gt,starred:vt,owned:W}),[vt,W,gt]);(0,l.useEffect)(()=>{T&&ct(T)},[T]);const ht=Y||At;return(0,l.useEffect)(()=>{!ht&&B&&B!=="all"&&pt[B]===0&&ct("all")},[ht,pt,B,ct]),(0,l.useEffect)(()=>{if(!B||ht)return;v({user:B==="owned"?ft:B==="starred"?yt:n.tN.all()})},[B,yt,ft,v,ht]),l.createElement(A.A,{className:e.root},k.map(ut=>l.createElement(l.Fragment,{key:ut.name},l.createElement($.A,{variant:"subtitle2",component:"span",className:e.title},ut.name),l.createElement(A.A,{className:e.groupWrapper},l.createElement(I.A,{disablePadding:!0,dense:!0,role:"menu","aria-label":ut.name},ut.items.map((ot,Ot)=>l.createElement(g.A,{role:"none presentation",key:ot.id,divider:Ot!==ut.items.length-1,onClick:()=>ct(ot.id),selected:ot.id===C.user?.value,className:e.menuItem,disabled:pt[ot.id]===0,"data-testid":`user-picker-${ot.id}`,tabIndex:0,ContainerProps:{role:"menuitem"}},ot.icon&&l.createElement(d.A,{className:e.listIcon},l.createElement(ot.icon,{fontSize:"small"})),l.createElement(S.A,null,l.createElement($.A,{variant:"body1"},ot.label," ")),l.createElement(o.A,null,pt[ot.id]??"-"))))))))}},49724:(st,M,t)=>{t.d(M,{I5:()=>$,Kf:()=>l,N9:()=>g,V3:()=>S,gM:()=>I,gZ:()=>j,mT:()=>n,qA:()=>d,q_:()=>o,tN:()=>L,z:()=>V});var a=t(78560),D=t(97214),A=t(699);class I{constructor(s){this.value=s}getCatalogFilters(){return{kind:this.value}}toQueryValue(){return this.value}}class d{constructor(s){this.value=s}getTypes(){return Array.isArray(this.value)?this.value:[this.value]}getCatalogFilters(){return{"spec.type":this.getTypes()}}toQueryValue(){return this.getTypes()}}class o{constructor(s){this.values=s}filterEntity(s){return this.values.every(c=>(s.metadata.tags??[]).includes(c))}getCatalogFilters(){return{"metadata.tags":this.values}}toQueryValue(){return this.values}}class S{constructor(s){this.value=s}filterEntity(s){const c=this.toUpperArray(this.value.split(/\s/)),F=this.toUpperArray([s.metadata.tags]),U=this.toUpperArray([s.metadata.name,s.metadata.title]);for(const X of c)if(F.every(z=>z!==X)&&U.every(z=>!z.includes(X)))return!1;return!0}getFullTextFilters(){return{term:this.value,fields:["metadata.name","metadata.title","spec.profile.displayName"]}}toQueryValue(){return this.value}toUpperArray(s){return s.flat().filter(c=>!!c).map(c=>c.toLocaleUpperCase("en-US"))}}class g{values;constructor(s){this.values=s.reduce((c,F)=>{try{return c.push((0,a.U2)((0,a.KU)(F,{defaultKind:"Group"}))),c}catch{return c}},[])}getCatalogFilters(){return{"relations.ownedBy":this.values}}filterEntity(s){return this.values.some(c=>(0,A.t)(s,D.vv).some(F=>(0,a.U2)(F)===c))}toQueryValue(){return this.values}}class ${constructor(s){this.values=s}getCatalogFilters(){return{"spec.lifecycle":this.values}}filterEntity(s){return this.values.some(c=>s.spec?.lifecycle===c)}toQueryValue(){return this.values}}class V{constructor(s){this.values=s}getCatalogFilters(){return{"metadata.namespace":this.values}}filterEntity(s){return this.values.some(c=>s.metadata.namespace===c)}toQueryValue(){return this.values}}class L{constructor(s,c){this.value=s,this.refs=c}static owned(s){return new L("owned",s)}static all(){return new L("all")}static starred(s){return new L("starred",s)}getCatalogFilters(){return this.value==="owned"?{"relations.ownedBy":this.refs??[]}:this.value==="starred"?{"metadata.name":this.refs?.map(s=>(0,a.KU)(s).name)??[]}:{}}filterEntity(s){if(this.value==="starred")return this.refs?.includes((0,a.U2)(s))??!0;if(this.value==="owned"){const c=(0,A.t)(s,D.vv);return this.refs?.some(F=>c.some(U=>(0,a.U2)(U)===F))??!1}return!0}toQueryValue(){return this.value}}class j{constructor(s,c,F){this.value=s,this.isOwnedEntity=c,this.isStarredEntity=F}filterEntity(s){switch(this.value){case"owned":return this.isOwnedEntity(s);case"starred":return this.isStarredEntity(s);default:return!0}}toQueryValue(){return this.value}}class l{constructor(s){this.value=s}getCatalogFilters(){return this.value?{"metadata.annotations.backstage.io/orphan":String(this.value)}:{}}filterEntity(s){const c=s.metadata.annotations?.["backstage.io/orphan"];return c!==void 0&&this.value.toString()===c}}class n{constructor(s){this.value=s}filterEntity(s){const c=s?.status?.items?.length>0;return c!==void 0&&this.value===c}}},18453:(st,M,t)=>{t.d(M,{B9:()=>n,nK:()=>h});var a=t(45250),D=t.n(a),A=t(45810),I=t.n(A),d=t(14041),o=t(18690),S=t(87290),g=t(22771),$=t(71581),V=t(30043),L=t(15998),j=t(18139);const l=(0,d.createContext)(void 0),n=s=>{const c=(0,$.A)(),F=(0,j.gf)(V.v),[U,X]=(0,d.useState)({}),z=(0,o.zy)(),x=s.pagination===!0?"cursor":typeof s.pagination=="object"?s.pagination.mode??"cursor":"none",w=typeof s.pagination=="object"?s.pagination.limit??20:20,{queryParameters:q,cursor:dt,offset:R,limit:Q}=(0,d.useMemo)(()=>{const P=I().parse(z.search,{ignoreQueryPrefix:!0});let H=w;if(typeof P.limit=="string"){const r=Number.parseInt(P.limit,10);isNaN(r)||(H=r)}const K=typeof P.offset=="string"&&x==="offset"?Number.parseInt(P.offset,10):void 0;return{queryParameters:P.filters??{},cursor:typeof P.cursor=="string"&&x==="cursor"?P.cursor:void 0,offset:x==="offset"&&K&&!isNaN(K)?K:void 0,limit:H}},[x,z.search,w]),[O,Z]=(0,d.useState)(dt),[b,at]=(0,d.useState)(R),[G,it]=(0,d.useState)(Q),[N,tt]=(0,d.useState)(()=>({appliedFilters:{},entities:[],backendEntities:[],pageInfo:x==="cursor"?{}:void 0,offset:b,limit:G})),[{loading:et,error:nt},lt]=(0,S.A)(async()=>{const P=(0,a.compact)(Object.values(U)),H=Object.keys(U).reduce((K,r)=>{const E=U[r];return E?.toQueryValue&&(K[r]=E.toQueryValue()),K},{});if(x!=="none")if(O){if(O!==N.appliedCursor){const K=(0,L.be)(P),r=await F.queryEntities({cursor:O,limit:G});tt({appliedFilters:U,appliedCursor:O,backendEntities:r.items,entities:r.items.filter(K),pageInfo:r.pageInfo,totalItems:r.totalItems})}}else{const K=(0,L.be)(P),r=(0,L.$3)(P),E=(0,L.$3)((0,a.compact)(Object.values(N.appliedFilters)));if(x==="offset"||!(0,a.isEqual)(E,r)){const u=await F.queryEntities({...r,limit:G,offset:b,orderFields:[{field:"metadata.name",order:"asc"}]});tt({appliedFilters:U,backendEntities:u.items,entities:u.items.filter(K),pageInfo:u.pageInfo,totalItems:u.totalItems,limit:G,offset:b})}}else{const K=(0,L.be)(P),r=(0,L.Rr)(P),E=(0,L.Rr)((0,a.compact)(Object.values(N.appliedFilters)));if((0,a.isEqual)(E,r)){const u=N.backendEntities.filter(K);tt({appliedFilters:U,backendEntities:N.backendEntities,entities:u,totalItems:u.length})}else{const u=await F.getEntities({filter:r}),e=u.items.filter(K);tt({appliedFilters:U,backendEntities:u.items,entities:e,totalItems:e.length})}}if(c()){const K=I().parse(z.search,{ignoreQueryPrefix:!0}),r=I().stringify({...K,filters:H,cursor:O,offset:b,limit:G},{addQueryPrefix:!0,arrayFormat:"repeat"}),E=`${window.location.pathname}${r}`;window.history?.replaceState(null,document.title,E)}},[F,q,U,N,O,x,G,b],{loading:!0});(0,g.A)(lt,10,[U,O,G,b]);const Et=(0,d.useCallback)(P=>{Z(void 0),X(H=>{const K=typeof P=="function"?P(H):P;return{...H,...K}})},[]),J=(0,d.useMemo)(()=>{if(x!=="cursor")return;const P=N.pageInfo?.prevCursor,H=N.pageInfo?.nextCursor;return{prev:P?()=>Z(P):void 0,next:H?()=>Z(H):void 0}},[x,N.pageInfo]),rt=(0,d.useMemo)(()=>({filters:N.appliedFilters,entities:N.entities,backendEntities:N.backendEntities,updateFilters:Et,queryParameters:q,loading:et,error:nt,pageInfo:J,totalItems:N.totalItems,limit:G,offset:b,setLimit:it,setOffset:at,paginationMode:x}),[N,Et,q,et,nt,J,G,b,x,it,at]);return d.createElement(l.Provider,{value:rt},s.children)};function h(){const s=(0,d.useContext)(l);if(!s)throw new Error("useEntityList must be used within EntityListProvider");return s}},44861:(st,M,t)=>{t.d(M,{I:()=>L});var a=t(78560),D=t(18139),A=t(14041),I=t(11746),d=t(46123),o=t.n(d),S=t(9974),g=t(96403),$=t.n(g);function V(j){return typeof j=="string"?j:(0,a.U2)(j)}function L(){const j=(0,D.gf)(S.a),l=(0,I.A)((0,A.useMemo)(()=>j.starredEntitie$(),[j]),new Set),n=(0,A.useCallback)(s=>l.has(V(s)),[l]),h=(0,A.useCallback)(s=>j.toggleStarred(V(s)).then(),[j]);return{starredEntities:l,toggleStarredEntity:h,isStarredEntity:n}}},15998:(st,M,t)=>{t.d(M,{$3:()=>A,Rr:()=>I,be:()=>d});var a=t(49724);function D(o){return!!o.getFullTextFilters}function A(o){const S=o.reduce(($,V)=>({...$,...V.getCatalogFilters?V.getCatalogFilters():{}}),{}),g=o.find(D)?.getFullTextFilters();return{filter:S,fullTextFilter:g}}function I(o){const S={};return o.forEach(g=>{g instanceof a.q_||g instanceof a.N9||g instanceof a.I5||g instanceof a.z||g instanceof a.tN||g instanceof a.Kf||g instanceof a.V3||g instanceof a.gZ||Object.assign(S,g.getCatalogFilters?.()||{})}),S}function d(o){return S=>o.every(g=>!g.filterEntity||g.filterEntity(S))}},44148:(st,M,t)=>{var a,D=t(4293),A=t(78920);a={value:!0},M.A=void 0;var I=A(t(14041)),d=D(t(74044)),o=(0,d.default)(I.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");M.A=o},41260:(st,M,t)=>{var a,D=t(4293),A=t(78920);a={value:!0},M.A=void 0;var I=A(t(14041)),d=D(t(74044)),o=(0,d.default)(I.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank");M.A=o},47966:(st,M,t)=>{var a,D=t(4293),A=t(78920);a={value:!0},M.A=void 0;var I=A(t(14041)),d=D(t(74044)),o=(0,d.default)(I.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"Group");M.A=o}}]);})();

//# sourceMappingURL=7248.fb82ffd4.chunk.js.map